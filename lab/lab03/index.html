<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content ="CS88: Computational Structures in Data Science " />
    <meta name="keywords" content ="CS88, Computer Science, Data Science, Programming, David Culler, Berkeley, EECS" />
    <meta name="author" content ="David Culler, Garrett Tan, Gunjan Baid, Richard Liang, Nishant Desai" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width">

    <script src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link rel="icon" href="/assets/images/favicon.ico">

    <link rel="stylesheet" href="/assets/css/mono-blue.css">
    <script src="/assets/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <link rel="stylesheet" type="text/css" href="/assets/css/resource.css" />
<link rel="stylesheet" type="text/css" href="/assets/css/lab.css" />


    <title>Lab 3: Environment Diagrams and Recursion | CS 88 Spring 2016</title>

  </head>

  <body id="index" class="home">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-section">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">CS 88</a>
        </div>

        <div class="collapse navbar-collapse" id="navbar-collapse-section">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/">Calendar</a></li>
            <li><a href="/articles/resources.html">Resources</a></li>
            <li><a href="/office-hours.html">Office Hours</a></li>
            <!--- <li><a href="/tutoring.html">Tutoring</a></li> -->

            <li><a href="/articles/using-ok.html">Using OK</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Course Info <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/articles/about.html">Syllabus</a></li>
                <li><a href="/staff.html">Staff</a></li>
                <!-- <li><a href="/weekly.html">Weekly Schedule</a></li> -->
                <!-- <li><a href="/extra.html">Extra Lectures</a></li> -->
              </ul>
            </li>

          </ul>
        </div>
      </div>
    </nav>

    <div id="content" class="container">
      <div class='row'>
  <div class='col-md-9'>
    <div class='page-header'>
      <h1><span class="content-title-brand">Lab 3</span>: Environment Diagrams and Recursion</h1>
    </div>

    <p><i>Due at 11:59pm on 02/26/2016.</i></p>

<h2 id='starter-files'>Starter Files</h2>

<p>Download <a href="lab03.zip">lab03.zip</a>.
Inside the archive, you will find starter files for the questions in this lab,
  along with a copy of the <a href="ok">OK</a> autograder.</p>

<h2 id='submission'>Submission</h2>

<p>By the end of this lab, you should have submitted the lab with
<code>python3 ok --submit</code>. You may submit more than once before the
deadline; only the final submission will be graded.</p>


<ul>
  <li>To receive credit for this lab, you must complete Questions 1, 6, and 7
  in <a href="lab03.py">lab03.py</a> and submit through OK.</li>
  <li>Questions 2, 3, 4, and 5 are to show you what some common recursion
  misconceptions and mistakes are. You can run Python interactively to test them out!</li>
  <li>Question 8 gives you much deeper insight into environment diagrams and 
  the computational struture under functions as return values.</li>
  <li>Questions 9 is <em>extra practice</em>. It can be found in the
  <a href="lab03_extra.py">lab03_extra.py</a> file. It is recommended that you complete
  this problem on your own time.</li>
</ul>

<p>We've tried to keep this lab a bit short so that you'll have time for some
worksheet problems and to work on your project.</p>



    


<h2 id="environment-diagrams">Environment Diagrams</h2>


<p>An <strong>environment diagram</strong> keeps track of all the variables that have
been defined and the values they are bound to.</p>

<pre><code>x = 3

def square(x):
    return x ** 2

square(2)</code></pre>

<p><img class="img-responsive center-block" src="assets/simpler_hof.png" alt="Environment diagram example picture"></p>

<p>When Python executes <em>assignment statements</em> (like <code>x = 3</code>), it
records the variable name and the value:</p>

<ol>
  <li>Evaluate the expression on the right side of the <code>=</code> sign.</li>
  <li>Write the variable name and the expression's value in the current frame.</li>
</ol>

<p>When Python executes <em><code>def</code> statements</em> (like <code>def square(x):</code>), it records the function
name and binds it to a function object:</p>

<ol>
  <li>Write the function name (<code>square</code>) in the frame and point
  it to a function object (<code>func square(x) [parent=Global]</code>).
  The <code>[parent=Global]</code> denotes the frame in which the function was
  <em>defined</em>.</li>
</ol>

<p>When Python executes a <em>call expression</em> (like <code>square(2)</code>), it
creates a new frame to keep track of local variables.</p>

<ol>
  <li><p>Draw a new frame. Label it with</p>

  <ul>
    <li>a unique index (<code>f1</code>, <code>f2</code>, <code>f3</code> and so on)</li>
    <li><p>the <strong>intrinsic name</strong> of the function (<code>square</code>), which is the name of the function
    object itself</p>

    <ul>
      <li>For example, if the function is <code>func square(x) [parent=Global]</code>, the
      intrinsic name is <code>square</code></li>
    </ul></li>
    <li>the parent frame (<code>[parent=Global]</code>)</li>
  </ul></li>
  <li>Bind the formal parameters to the arguments passed in (e.g. bind <code>x</code> to 3).</li>
  <li>Evaluate the body of the function.</li>
</ol>

<p>If a function does not have a return value, it implicitly returns <code>None</code>.
Thus, the "Return value" box should contain <code>None</code>.</p>

<hr/>

<p>Since we do not know how built-in functions like <code>add(...)</code> or <code>min(...)</code> or <code>print(...)</code> are
implemented, we do <em>not</em> draw a new frame when we call built-in functions.</p>


<h2 id="recursion">Recursion</h2>


<p>A recursive function is a function that calls itself in its body,
either directly or indirectly. Recursive functions have three important
components:</p>

<ol>
  <li>Base case(s), the simplest possible form of the problem you're trying to solve.</li>
  <li>Consider a recursive call on a smaller argument.</li>
  <li>Recursive case(s), where the function calls itself with a <em>simpler
  argument</em> as part of the computation.</li>
</ol>

<p>Let's look at the canonical example, <code>factorial</code>:</p>

<pre><code>def factorial(n):
    if n == 0:
        return 1
    return n * factorial(n &#x2d; 1)</code></pre>

<p>We know by its definition that <code>0!</code> is <code>1</code>. So we choose <code>n = 0</code> as our
base case. The recursive step also follows from the definition of
factorial, i.e.  <code>n! = n * (n&#x2d;1)!</code>.</p>

<p>The next few questions in lab will have you writing recursive
functions.  Here are some general tips:</p>

<ul>
  <li>Consider how you can solve the current problem using the solution to
  a simpler version of the problem. Remember to <em>trust the recursion</em>:
  assume that your solution to the simpler problem works correctly
  without worrying about how.</li>
  <li>Think about what the answer would be in the simplest possible
  case(s). These will be your base cases - the stopping points for your
  recursive calls. Make sure to consider the possibility that you're
  missing base cases (this is a common way recursive solutions fail).</li>
  <li>It may help to write the iterative version first.</li>
</ul>

<!-- <table class='table table-bordered'>

<pre><code>&lt;tr&gt;
    &lt;th&gt;Function Type:&lt;/th&gt;
    &lt;th&gt;Recusive&lt;/th&gt;
    &lt;th&gt;Iterative&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;Function&lt;/td&gt;
    &lt;td&gt;&lt;pre&gt; def factorial(n):
    if n == 0:
        return 1
    return n * factorial(n &#x2d; 1)&lt;pre&gt;&lt;/td&gt;
    &lt;td&gt;&lt;pre&gt; def factorial(n):
    total = 1
    while n &gt; 0:
        total *= n
        n &#x2d;= 1
    return total
    &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;Ends calculations&lt;/td&gt;
    &lt;td&gt;When it hits the base case&lt;/td&gt;
    &lt;td&gt;When n !&gt; 0, it will end.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;Means of traversal&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;factorial(&lt;strong&gt;n &#x2d; 1&lt;/strong&gt;&lt;/code&gt;&lt;/td&gt;
    &lt;td&gt;&lt;code&gt;&lt;strong&gt;n &#x2d;= 1&lt;/strong&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt; 
&lt;/tr&gt;</code></pre>

</table> -->

<h3 class="question" id="q1">Question 1: Skip Add</h3>

<p>Write a function <code>skip_add</code> that takes a single argument <code>n</code>
and computes the sum of every other integer between 0 and <code>n</code> 
starting from n. Assume <code>n</code> is non-negative.</p>



<pre><code>def skip_add(n):
    &quot;&quot;&quot; Takes a number x and returns x + x&#x2d;2 + x&#x2d;4 + x&#x2d;6 + ... + 0.

    &gt;&gt;&gt; skip_add(5)  # 5 + 3 + 1 + 0
    9
    &gt;&gt;&gt; skip_add(10) # 10 + 8 + 6 + 4 + 2 + 0
    30
    &quot;&quot;&quot;
<div class="alt 1">    "*** YOUR CODE HERE ***"
</div><div class="solution 1">&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x6e;&#x20;&#x3c;&#x3d;&#x20;&#x30;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x30;&#xa;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x6e;&#x20;&#x2b;&#x20;&#x73;&#x6b;&#x69;&#x70;&#x5f;&#x61;&#x64;&#x64;&#x28;&#x6e;&#x20;&#x2d;&#x20;&#x32;&#x29;</div></code></pre>


    <button id='1' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>
    

<p>Use OK to test your code:</p><pre><code>python3 ok -q skip_add</code></pre>

<h3 class="question" id="q2">Question 2: Remove from sequence</h3>

<p>Complete the recursive function <code>remove</code> which removes the first element in a
sequence that is equal to a specified value.</p>



<pre><code>def first(s):
    &quot;&quot;&quot;Return the first element in a sequence.&quot;&quot;&quot;
    return s[0]

def rest(s):
    &quot;&quot;&quot;Return all elements in a sequence after the first&quot;&quot;&quot;
    return s[1:]

def remove(x, s):
    &quot;&quot;&quot;Remove first element equal to x from sequence s.

    &gt;&gt;&gt; remove(1,[])
    []
    &gt;&gt;&gt; remove(1,[1])
    []
    &gt;&gt;&gt; remove(1,[1,1])
    [1]
    &gt;&gt;&gt; remove(1,[2,1])
    [2]
    &gt;&gt;&gt; remove(1,[3,1,2])
    [3, 2]
    &gt;&gt;&gt; remove(1,[3,1,2,1])
    [3, 2, 1]
    &gt;&gt;&gt; remove(5, [3, 5, 2, 5, 11])
    [3, 2, 5, 11]
    &quot;&quot;&quot;
<div class="alt 2">    "*** YOUR CODE HERE ***"
</div><div class="solution 2">&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x6e;&#x6f;&#x74;&#x20;&#x73;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x5b;&#x5d;&#xa;&#x20;&#x20;&#x20;&#x20;&#x65;&#x6c;&#x69;&#x66;&#x20;&#x66;&#x69;&#x72;&#x73;&#x74;&#x28;&#x73;&#x29;&#x20;&#x3d;&#x3d;&#x20;&#x78;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x72;&#x65;&#x73;&#x74;&#x28;&#x73;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x65;&#x6c;&#x73;&#x65;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x5b;&#x66;&#x69;&#x72;&#x73;&#x74;&#x28;&#x73;&#x29;&#x5d;&#x20;&#x2b;&#x20;&#x72;&#x65;&#x6d;&#x6f;&#x76;&#x65;&#x28;&#x78;&#x2c;&#x20;&#x72;&#x65;&#x73;&#x74;&#x28;&#x73;&#x29;&#x29;</div></code></pre>


    <button id='2' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>
    

<p>Illustrated here is a more complete doctest that shows good testing methodology.
It is a little cumbersome as documentation, but you'll want to think about it
for your projects.  Test every condition that might come up.  Then you won't be
surprised when it does.</p>

</question Remove from sequence>

<h3 class="question" id="q3">Question 3: Common Misconception</h3>

<p>Fix the error with the following recursive function.</p>

<pre><code>def factorial(n):
    &quot;&quot;&quot;Return n * (n &#x2d; 1) * (n &#x2d; 2) * ... * 1.

    &gt;&gt;&gt; factorial(5)
    120
    &quot;&quot;&quot;
    if n == 0:
        return 1
    else:
        n * factorial(n&#x2d;1)</code></pre>


    <button id='6' class='toggleButtonShow'>
    Toggle Explanation<noscript> (enable JavaScript)</noscript>
    </button>
    <div class="solution 6">

<p>The result of the recursive calls is not returned.</p>

<pre><code>def factorial(n):
    if n == 0:
        return 1
    else:
        return n * factorial(n&#x2d;1)</code></pre>

</div>

<h3 class="question" id="q4">Question 4: Common Misconception</h3>

<p>Fix the error with this recursive function.</p>

<pre><code>def skip_mul(n):
    &quot;&quot;&quot;Return the product of n * (n &#x2d; 2) * (n &#x2d; 4) * ...

    &gt;&gt;&gt; skip_mul(5) # 5 * 3 * 1
    15
    &gt;&gt;&gt; skip_mul(8) # 8 * 6 * 4 * 2  * 0
    0
    &quot;&quot;&quot;
    if n == 0:
        return 0
    else:
        return n * skip_mul(n &#x2d; 2)</code></pre>


    <button id='7' class='toggleButtonShow'>
    Toggle Explanation<noscript> (enable JavaScript)</noscript>
    </button>
    <div class="solution 7">

<p>Consider what happens when we choose an odd number for <code>n</code>.  <code>skip_mul(3)</code> will
return <code>3 * skip_mul(1)</code>. <code>skip_mul(1)</code> will return <code>1 * skip_mul(&#x2d;1)</code>.  You
may see the problem now. Since we are decreasing <code>n</code> by two at a time, we've
completed missed our base case of <code>n == 0</code>, and we will end up recursing
indefinitely. We need to add another base case to make sure this doesn't
happen.</p>

<pre><code>def skip_mul(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return n * skip_mul(n &#x2d; 2)</code></pre>

</div>

<h3 class="question" id="q5">Question 5: Common Misconception</h3>

<p>The following recursive function appears to work, in that it returns
a list <code>[1, ..., n]</code>.  (Try it out.) But just because it happens to 
work doesn't make it right.  What is wrong with it?</p>

<pre><code>i = 0
def count_up(n):
    global i
    if n == 0:
        return []
    else:
        i = i+1
        return [i] + count_up(n&#x2d;1)

count_up(5)</code></pre>


    <button id='8' class='toggleButtonShow'>
    Toggle Explanation<noscript> (enable JavaScript)</noscript>
    </button>
    <div class="solution 8">

<p>The use of global variable i throughout the recursion to count up
is extremely error prone.  Who knows what value <code>i</code> has when this is
called.  It just happens to be set to <code>0</code> in this case. This was
probaby what was intended.</p>

<pre><code>def count_up(i, n):
    if i &gt; n:
        return []
    else:
        return [i] + count_up(i+1, n)

count_up(1,5)</code></pre>

</div>

<h3 class="question" id="q6">Question 6: GCD</h3>

<p>The greatest common divisor of two positive integers <code>a</code> and <code>b</code> is the
largest integer which evenly divides both numbers (with no remainder).
Euclid, a Greek mathematician in 300 B.C., realized that the greatest
common divisor of <code>a</code> and <code>b</code> is one of the following:</p>

<ul>
  <li>the smaller value if it evenly divides the larger value, OR</li>
  <li>the greatest common divisor of the smaller value and the remainder of
  the larger value divided by the smaller value</li>
</ul>

<p>In other words, if <code>a</code> is greater than <code>b</code> and <code>a</code> is not divisible by
<code>b</code>, then</p>

<pre><code>gcd(a, b) == gcd(b, a % b)</code></pre>

<p>Write the <code>gcd</code> function recursively using Euclid's algorithm.</p>



<pre><code>def gcd(a, b):
    &quot;&quot;&quot;Returns the greatest common divisor of a and b.
    Should be implemented using recursion.

    &gt;&gt;&gt; gcd(34, 19)
    1
    &gt;&gt;&gt; gcd(39, 91)
    13
    &gt;&gt;&gt; gcd(20, 30)
    10
    &gt;&gt;&gt; gcd(40, 40)
    40
    &quot;&quot;&quot;
<div class="alt 3">    "*** YOUR CODE HERE ***"
</div><div class="solution 3">&#x20;&#x20;&#x20;&#x20;&#x61;&#x2c;&#x20;&#x62;&#x20;&#x3d;&#x20;&#x6d;&#x61;&#x78;&#x28;&#x61;&#x2c;&#x20;&#x62;&#x29;&#x2c;&#x20;&#x6d;&#x69;&#x6e;&#x28;&#x61;&#x2c;&#x20;&#x62;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x61;&#x20;&#x25;&#x20;&#x62;&#x20;&#x3d;&#x3d;&#x20;&#x30;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x62;&#xa;&#x20;&#x20;&#x20;&#x20;&#x65;&#x6c;&#x73;&#x65;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x67;&#x63;&#x64;&#x28;&#x62;&#x2c;&#x20;&#x61;&#x20;&#x25;&#x20;&#x62;&#x29;</div></code></pre>


    <button id='3' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>
    

<p>Use OK to test your code:</p><pre><code>python3 ok -q gcd</code></pre>

<p>This is an example of the elegance that recursive solutions permit.  Here
for comparison is an iterative solution.</p>

<pre><code># Iterative solution, if you&#x27;re curious
def gcd_iter(a, b):
    &quot;&quot;&quot;Returns the greatest common divisor of a and b, using iteration.

    &gt;&gt;&gt; gcd_iter(34, 19)
    1
    &gt;&gt;&gt; gcd_iter(39, 91)
    13
    &gt;&gt;&gt; gcd_iter(20, 30)
    10
    &gt;&gt;&gt; gcd_iter(40, 40)
    40
    &quot;&quot;&quot;
    if a &lt; b:
        return gcd_iter(b, a)
    while a &gt; b and not a % b == 0:
        a, b = b, a % b
    return b</code></pre>

</question GCD>

<h3 class="question" id="q7">Question 7: Recursive min sort</h3>

<p>In data8 you have found sort to be instrumental to analysis of data.  In cs88 you
get to build it.  There are many sorting algorithms; they have interesting differences
and elegant implementations.  In lecture we saw a tree recursive formulation of Quick Sort
based on the following thinking:</p>

<ul>
  <li>base: an empty list is sorted</li>
  <li>recursive leap: to sort a list of length <code>n</code>, assume qsort works for all lists
  of length <code>&lt; n</code>; remove the first element, use it to split the rest into two sets (all less-or-equal and all greater), sort both recursively, and put the three pieces back together.</li>
</ul>

<p>In this question we will build another sort algorithm and compare the two using some of your
data8 skills.  Here is another idea for sorting.</p>

<ul>
  <li>base: an empty list is sorted</li>
  <li>recursive leap: to sort a list of length <code>n &gt; 0</code>, (assume that your function will 
  correctly sort lists of length <code>n&#x2d;1</code>) remove the minimum element in the sequence; 
  sort the remaining list of length <code>n &#x2d; 1</code> recursively, put the min element in front
  of the the sorted remainder.</li>
</ul>

<p>You already have a function to find the minimum element (recursively) from lecture and a 
function to remove the first occurence of an element (recursively) from this lab.
<br/>
Now you can use those to sort a list (recursively). Complete <code>rsort</code></p>



<pre><code># Recursive min sort

def rmin(s):
    &quot;&quot;&quot;Return the minimum value in a sequence.&quot;&quot;&quot;
    if len(s) == 1:
        return first(s)
    else:
        return min(first(s), rmin(rest(s)))

def rsort(s):
    &quot;&quot;&quot;Sort sequence s in ascending order.

    &gt;&gt;&gt; rsort([])
    []
    &gt;&gt;&gt; rsort([1])
    [1]
    &gt;&gt;&gt; rsort([1, 1, 1])
    [1, 1, 1]
    &gt;&gt;&gt; rsort([1, 2, 3])
    [1, 2, 3]
    &gt;&gt;&gt; rsort([3, 2, 1])
    [1, 2, 3]
    &gt;&gt;&gt; rsort([1, 2, 1])
    [1, 1, 2]
    &gt;&gt;&gt; rsort([1,2,3, 2, 1])
    [1, 1, 2, 2, 3]
    &quot;&quot;&quot;
<div class="alt 4">    "*** YOUR CODE HERE ***"
</div><div class="solution 4">&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x6e;&#x6f;&#x74;&#x20;&#x73;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x5b;&#x5d;&#xa;&#x20;&#x20;&#x20;&#x20;&#x65;&#x6c;&#x73;&#x65;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x6d;&#x69;&#x6e;&#x5f;&#x76;&#x61;&#x6c;&#x75;&#x65;&#x20;&#x3d;&#x20;&#x72;&#x6d;&#x69;&#x6e;&#x28;&#x73;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x61;&#x66;&#x74;&#x65;&#x72;&#x5f;&#x6d;&#x69;&#x6e;&#x20;&#x3d;&#x20;&#x72;&#x65;&#x6d;&#x6f;&#x76;&#x65;&#x28;&#x6d;&#x69;&#x6e;&#x5f;&#x76;&#x61;&#x6c;&#x75;&#x65;&#x2c;&#x20;&#x73;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x5b;&#x6d;&#x69;&#x6e;&#x5f;&#x76;&#x61;&#x6c;&#x75;&#x65;&#x5d;&#x20;&#x2b;&#x20;&#x72;&#x73;&#x6f;&#x72;&#x74;&#x28;&#x61;&#x66;&#x74;&#x65;&#x72;&#x5f;&#x6d;&#x69;&#x6e;&#x29;</div></code></pre>


    <button id='4' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>
    

<p>A fundamental concept in computer science is understanding the "cost" of solving problems
using an algorithm; this is called the <em>complexity</em> of the algorithm.  For the amount of
work involved in sorting, we may consider the comparison, i.e., less-or-equal, to be the
basic unit of work.  The question is "How many comparisons are required to sort of sequence
of length <code>n</code> using a particular algorithm?"  We can try to answer it analytically or
empirically.  Let's try both.</p>

<p><em>Analytically:</em> For your <code>rsort</code> on a sequence of length <code>n</code>, how many comparisons
are required as a function of <code>n</code>?  Start with <code>n == 1</code>.  Then do <code>n = 2,3, ...</code>.
<br/>
Draw a picture.  Figure out the rule.  (It is a simple formula).</p>

<p><em>Empirically:</em> You can use all that you are learning in data8 to analyze data about
programs.  At <a href="http://data8.org/cs-connector/">http://data8.org/cs-connector/</a> you
will find a link for a notebook to use for this lab.  There is both an interactive
link to open it on data8 and a download link now that you have the full datascience
environment installed on your machine.  You can use either one.  (To run it locally
on your machine you need to activate cs88 (remember it's different on windows and mac)
and then run <code>jupyter notebook</code> in the directory that contains the notebook file.</p>

<p>In that notebook you will find a funny version of <code>leq</code> that uses a global variable
to keep count of how many times it is called.  And there is a (higher order) function <code>measure</code>
that take a function and data and measures the number of calls to <code>leq</code> in running
that function on that data.  To get you started, 
we have done a little analysis of <code>qsort</code> on already sorted data.</p>

<ul>
  <li>Extend the notebook to compare the complexity of <code>rsort</code> and <code>qsort</code>
  on already sorted data. Use this to verify your analytical analysis.  When
  you think about what quick sort does on sorted data, do the results make sense?</li>
  <li>Now the really interesting part.  Do another cell comparing the complexity of these
  two functions on randomly permuted data.  Can you explain the difference that you see?</li>
</ul>

<h3 class="question" id="q8">Question 8: Understanding environments</h3>

<p>We saw the combination of tail recursion and higher order functions in an sum-of-squares example.</p>

<pre><code>def sum_of_squares(n):
    def sum_upper(i, accum):
        if i &gt; n:
            return accum
        else:
            return sum_upper(i+1, accum + i*i)

    return sum_upper(1,0)</code></pre>

<p>Open this program up in python tutor and step through the its exeuction on 
<code>sum_of_squares(3)</code>.</p>

<p><a href="http://pythontutor.com/composingprograms.html#code=def+sum_of_squares(n%29%3A%0A++++def+sum_upper(i,+accum%29%3A%0A++++++++if+i+%3E+n%3A%0A++++++++++++return+accum%0A++++++++else%3A%0A++++++++++++return+sum_upper(i%2B1,+accum+%2B+i*i%29%0A++++++++%0A++++return+sum_upper(1,0%29%0A++++%0Asum_of_squares(3%29&mode=display&origin=composingprograms.js&cumulative=true&py=3&rawInputLstJSON=%5B%5D&curInstr=0">Open in pythontutor.com</a></p>

<ul>
  <li>What names are in the global frame?</li>
  <li>How many frames of <code>sum_of_squares</code> are allocated during execution?</li>
  <li>What are the local variables in a <code>sum_of_squares</code> frame?</li>
  <li>How many frames of <code>sum_upper</code> are allocated during execution?</li>
  <li>What are the local variables in each frames of sum_upper?</li>
  <li>Do they contain the same values?</li>
  <li>How is the variable <code>n</code> referenced from within <code>sum_upper</code>?</li>
  <li>What would happen if you tried to call <code>sum_upper</code> from the top level, e.g., 
  at the interpreter prompt?</li>
</ul>


    <button id='9' class='toggleButtonShow'>
    Toggle Explanation<noscript> (enable JavaScript)</noscript>
    </button>
    <div class="solution 9">

<ul>
  <li><code>sum_of_squares</code> is the only name in the global frame.</li>
  <li>One <code>sum_of_squares</code> frame is allocated.</li>
  <li>Four <code>sum_upper</code> frames are allocated in executing <code>sum_of_squares(3)</code>. <code>n+1</code> in general.</li>
  <li>Each of these contain distinct local variables <code>i</code> and <code>accum</code> (and possibly some temporaries that you don't see.)</li>
  <li>All the calls to <code>sum_upper</code> reference the instance of variable <code>n</code> in the <code>sum_of_squares</code> frame.</li>
  <li>Attempting to call <code>sum_upper</code> in global scope would result in a "undefined" error.  It is only defined within <code>sum_of_squares</code>.  Notice while we do make a function, we do not return it or
  allow it to escape the scope of <code>sum_of_squares</code> in any way.
  </div></li>
</ul>


<h2 id="extra-questions">Extra Questions</h2>


<blockquote><p>Questions in this section are not required for submission. However,
we encourage you to try them out on your own time for extra practice.</p></blockquote>

<h3 class="question" id="q9">Question 9: Interleaved Sum</h3>

<p>Recall that the <code>summation</code> function computes the sum of a sequence of
terms from 1 to <code>n</code>:</p>

<pre><code>def summation(n, term):
    &quot;&quot;&quot;Return the sum of the first n terms of a sequence.

    &gt;&gt;&gt; summation(5, lambda x: pow(x, 3))
    225
    &quot;&quot;&quot;
    total, k = 0, 1
    while k &lt;= n:
        total, k = total + term(k), k + 1
    return total</code></pre>

<p>Two things to note here.  First, the funny <code>lambda</code> that you haven't seen
yet is a slick way to create an anonymous function.  We'll see it later.
Here we are using it just for testing. It is simpler than something like:</p>

<pre><code>&gt;&gt;&gt; def cube(x):
...    return pow(x,3)
&gt;&gt;&gt; summation(5, cube)
225</code></pre>

<p>Secondly, this is showing a <code>while</code> loop to do what we would do in a more 
structured fashion with a <code>for</code> loop.</p>

<pre><code>def summation(n,term):
    total = 0
    for k in range(1,n+1):
        total = total + term(k)
    return total</code></pre>

<p>At this point, you should be able to read (or write) either one.  However,
you should write the one that reads most clearlyn</p>

<p>Write a function <code>interleaved_sum</code> that similarly computes the sum of a
sequence of terms from 1 to <code>n</code>, but uses different function to compute
the terms for odd and even numbers. Do so without using any loops or
testing in any way if a number is odd or even. (You may test if a
number is equal to 0, 1, or <code>n</code>.)</p>

<blockquote><p><em>Hint</em>: Use recursion and a helper function!</p></blockquote>



<pre><code>def interleaved_sum(n, odd_term, even_term):
    &quot;&quot;&quot;Compute the sum odd_term(1) + even_term(2) + odd_term(3) + ..., up
    to n.

    &gt;&gt;&gt; # 1 + 2^2 + 3 + 4^2 + 5
    ... interleaved_sum(5, lambda x: x, lambda x: x*x)
    29
    &quot;&quot;&quot;
<div class="alt 5">    "*** YOUR CODE HERE ***"
</div><div class="solution 5">&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x28;&#x6e;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x31;&#x29;&#xa;&#xa;&#x64;&#x65;&#x66;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x28;&#x6e;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x31;&#x2c;&#x20;&#x6b;&#x29;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x6b;&#x20;&#x3d;&#x3d;&#x20;&#x6e;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x28;&#x6b;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x28;&#x6b;&#x29;&#x20;&#x2b;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x28;&#x6e;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x31;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x2c;&#x20;&#x6b;&#x2b;&#x31;&#x29;&#xa;&#xa;&#x23;&#x20;&#x41;&#x6c;&#x74;&#x65;&#x72;&#x6e;&#x61;&#x74;&#x65;&#x20;&#x73;&#x6f;&#x6c;&#x75;&#x74;&#x69;&#x6f;&#x6e;&#xa;&#x64;&#x65;&#x66;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x73;&#x75;&#x6d;&#x32;&#x28;&#x6e;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x29;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x22;&#x22;&#x22;&#x43;&#x6f;&#x6d;&#x70;&#x75;&#x74;&#x65;&#x20;&#x74;&#x68;&#x65;&#x20;&#x73;&#x75;&#x6d;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x28;&#x31;&#x29;&#x20;&#x2b;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x28;&#x32;&#x29;&#x20;&#x2b;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x28;&#x33;&#x29;&#x20;&#x2b;&#x20;&#x2e;&#x2e;&#x2e;&#x2c;&#x20;&#x75;&#x70;&#xa;&#x20;&#x20;&#x20;&#x20;&#x74;&#x6f;&#x20;&#x6e;&#x2e;&#xa;&#xa;&#x20;&#x20;&#x20;&#x20;&#x3e;&#x3e;&#x3e;&#x20;&#x23;&#x20;&#x31;&#x20;&#x2b;&#x20;&#x32;&#x5e;&#x32;&#x20;&#x2b;&#x20;&#x33;&#x20;&#x2b;&#x20;&#x34;&#x5e;&#x32;&#x20;&#x2b;&#x20;&#x35;&#xa;&#x20;&#x20;&#x20;&#x20;&#x2e;&#x2e;&#x2e;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x73;&#x75;&#x6d;&#x32;&#x28;&#x35;&#x2c;&#x20;&#x6c;&#x61;&#x6d;&#x62;&#x64;&#x61;&#x20;&#x78;&#x3a;&#x20;&#x78;&#x2c;&#x20;&#x6c;&#x61;&#x6d;&#x62;&#x64;&#x61;&#x20;&#x78;&#x3a;&#x20;&#x78;&#x2a;&#x78;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x32;&#x39;&#xa;&#x20;&#x20;&#x20;&#x20;&#x22;&#x22;&#x22;&#xa;&#x20;&#x20;&#x20;&#x20;&#x74;&#x6f;&#x74;&#x61;&#x6c;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x31;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x32;&#x28;&#x6e;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x74;&#x6f;&#x74;&#x61;&#x6c;&#xa;&#xa;&#x64;&#x65;&#x66;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x32;&#x28;&#x6e;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x29;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x69;&#x66;&#x20;&#x6e;&#x20;&#x3d;&#x3d;&#x20;&#x31;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x28;&#x31;&#x29;&#x2c;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#xa;&#x20;&#x20;&#x20;&#x20;&#x65;&#x6c;&#x73;&#x65;&#x3a;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x74;&#x6f;&#x74;&#x61;&#x6c;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x31;&#x20;&#x3d;&#x20;&#x69;&#x6e;&#x74;&#x65;&#x72;&#x6c;&#x65;&#x61;&#x76;&#x65;&#x64;&#x5f;&#x68;&#x65;&#x6c;&#x70;&#x65;&#x72;&#x32;&#x28;&#x6e;&#x2d;&#x31;&#x2c;&#x20;&#x6f;&#x64;&#x64;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x2c;&#xa;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x20;&#x65;&#x76;&#x65;&#x6e;&#x5f;&#x74;&#x65;&#x72;&#x6d;&#x29;&#xa;&#x20;&#x20;&#x20;&#x20;&#x72;&#x65;&#x74;&#x75;&#x72;&#x6e;&#x20;&#x74;&#x6f;&#x74;&#x61;&#x6c;&#x20;&#x2b;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;&#x28;&#x6e;&#x29;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x31;&#x2c;&#x20;&#x74;&#x65;&#x72;&#x6d;&#x30;</div></code></pre>


    <button id='5' class='toggleButton'>
    Toggle Solution<noscript> (enable JavaScript)</noscript>
    </button>
    

<p>Use OK to test your code:</p><pre><code>python3 ok -q interleaved_sum</code></pre>


<h2 id="environment-diagram-rules">Environment Diagram Rules</h2>


<ol>
  <li><p>Creating a Function</p>

  <ul>
    <li>Draw the func <code>&lt;name&gt;(&lt;arg1&gt;, &lt;arg2&gt;, ...)</code></li>
    <li>The parent of the function is wherever the function was defined (the frame we're currently in, since we're creating the function).</li>
    <li>If we used def, make a binding of the name to the value in the current frame.</li>
  </ul></li>
  <li><p>Calling User Defined Functions</p>

  <ul>
    <li>Evaluate the operator and operands.</li>
    <li>Create a new frame; the parent is whatever the operator's parent is. Now this is the current frame.</li>
    <li>Bind the formal parameters to the argument values (the evaluated operands).</li>
    <li>Evaluate the body of the operator in the context of this new frame.</li>
    <li>After evaluating the body, go back to the frame that called the function.</li>
  </ul></li>
  <li><p>Assignment</p>

  <ul>
    <li>Evaluate the expression to the right of the assignment operator (=).</li>
    <li><p>If nonlocal, find the frame that has the variable you're looking for, starting in the parent frame and ending just before the global frame (via Lookup rules). Otherwise, use the current frame.</p>

    <ul>
      <li>Note: If there are multiple frames that have the same variable, pick the frame closest to the current frame.</li>
    </ul></li>
    <li>Bind the variable name to the value of the expression in the identified frame. Be sure you override the variable name if it had a previous binding.</li>
  </ul></li>
  <li><p>Lookup</p>

  <ul>
    <li>Start at the current frame. Is the variable in this frame? If yes, that's the answer.</li>
    <li>If it isn't, go to the parent frame and repeat 1.</li>
    <li>If you run out of frames (reach the Global frame and it's not there), complain.</li>
  </ul></li>
  <li><p>Tips</p>

  <ul>
    <li>You can only bind names to values. No expressions (like 3+4) allowed on environment diagrams!</li>
    <li>Frames and Functions both have parents.</li>
  </ul></li>
</ol>

  </div>

  <div class='col-md-3'>
    <nav class='hidden-print hidden-sm hidden-xs sidebar'>
      <ul>
  <li><a href="#environment-diagrams">Environment Diagrams</a></li>
  <li><a href="#recursion">Recursion</a></li>
  <ul>
  <li><a href="#q1">Question 1: Skip Add</a></li>
  <li><a href="#q2">Question 2: Remove from sequence</a></li>
  <li><a href="#q3">Question 3: Common Misconception</a></li>
  <li><a href="#q4">Question 4: Common Misconception</a></li>
  <li><a href="#q5">Question 5: Common Misconception</a></li>
  <li><a href="#q6">Question 6: GCD</a></li>
  <li><a href="#q7">Question 7: Recursive min sort</a></li>
  <li><a href="#q8">Question 8: Understanding environments</a></li>
</ul>

  <li><a href="#extra-questions">Extra Questions</a></li>
  <ul>
  <li><a href="#q9">Question 9: Interleaved Sum</a></li>
</ul>

  <li><a href="#environment-diagram-rules">Environment Diagram Rules</a></li>
</ul>

    </nav>
  </div>

</div>
    </div>
  </body>
  <script>
  $('.sidebar ul').addClass('nav nav-stacked');
  $('body').scrollspy({
    target: '.sidebar',
    offset: 40
  });
</script>
<script src="//code.jquery.com/jquery-latest.js"></script>
<script>
  $(function() {
    if (new Date("03/1/2016") < new Date()) {
      $('.toggleButton').css('display', 'inline-block');
      $('.toggleButton').click(function() {
        var solution_id = $(this).attr('id');
        $('div.' + solution_id).slideToggle(600);
      });
    }
    // Always display these toggle buttons
    $('.toggleButtonShow').click(function() {
      var solution_id = $(this).attr('id');
      $('div.' + solution_id).slideToggle(600);
    });
  });
</script>
</html>
